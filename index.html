<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hệ thống thi trắc nghiệm</title>

<style>
:root{
  --primary:#2563eb;
  --correct:#16a34a;
  --wrong:#dc2626;
  --bg:#f1f5f9;
}

body{
  margin:0;
  font-family:system-ui,-apple-system,BlinkMacSystemFont;
  background:var(--bg);
}

.container{
  max-width:900px;
  margin:auto;
  padding:16px;
}

.card{
  background:#fff;
  border-radius:16px;
  padding:16px;
  margin-bottom:12px;
  box-shadow:0 6px 16px rgba(0,0,0,.08);
}

.hidden{display:none}

input{
  width:100%;
  padding:14px;
  font-size:16px;
  border-radius:12px;
  border:1px solid #ccc;
}

button{
  width:100%;
  padding:14px;
  margin-top:10px;
  border-radius:14px;
  border:2px solid #cbd5e1;
  background:#f8fafc;
  font-size:16px;
  cursor:pointer;
  transition:.2s;
}

button:active{transform:scale(.97)}

.primary{
  background:var(--primary);
  color:#fff;
  border:none;
}

.answer{
  text-align:left;
  animation:fadeIn .2s ease;
}

.answer.selected{
  border:3px solid var(--primary);
  background:#eff6ff;
  font-weight:600;
}

@keyframes fadeIn{
  from{opacity:0;transform:translateY(5px)}
  to{opacity:1;transform:none}
}

.shake{
  animation:shake .3s;
}

@keyframes shake{
  0%{transform:translateX(0)}
  25%{transform:translateX(-5px)}
  50%{transform:translateX(5px)}
  75%{transform:translateX(-5px)}
  100%{transform:translateX(0)}
}

.timer{
  font-weight:bold;
  color:#dc2626;
  margin-bottom:10px;
}

.nav{
  display:grid;
  grid-template-columns:repeat(6,1fr);
  gap:6px;
}

.nav div{
  padding:8px;
  border-radius:8px;
  background:#e5e7eb;
  text-align:center;
  font-size:14px;
}

.nav .done{background:#93c5fd}
.nav .correct{background:#4ade80}
.nav .wrong{background:#f87171}

@media(max-width:600px){
  .nav{grid-template-columns:repeat(5,1fr)}
}
</style>
</head>

<body>
<div class="container">

<!-- START -->
<div id="start" class="card">
  <h2>Nhập tên người làm bài</h2>
  <input id="username" placeholder="Họ và tên">
  <button class="primary" onclick="start()">Bắt đầu làm bài</button>
</div>

<!-- QUIZ -->
<div id="quiz" class="hidden">

<div class="card">
  <div class="timer">⏱ Thời gian còn lại: <span id="time"></span></div>
  <div class="nav" id="nav"></div>
</div>

<div class="card">
  <h3 id="qtext"></h3>
  <div id="answers"></div>
  <button id="nextBtn" class="primary hidden" onclick="next()">Câu tiếp theo</button>
  <button id="finishBtn" class="primary hidden" onclick="finish()">Hoàn thành bài</button>
</div>

</div>

<!-- RESULT -->
<div id="result" class="hidden card"></div>

</div>

<audio id="clickSound">
  <source src="https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg">
</audio>

<script>
/* ====== CÂU HỎI (BẠN DÁN ĐỦ 30 CÂU VÀO ĐÂY) ====== */
const questions = [
{
  q:"Đâu không phải là nguyên tắc tổ chức và hoạt động của bộ máy Nhà nước Cộng hòa xã hội chủ nghĩa Việt Nam?",
  a:["Tập trung dân chủ","Đảng lãnh đạo","Công khai minh bạch","Bình đẳng, đoàn kết dân tộc"],
  c:2
},
{
  q:"Cơ quan quyền lực nhà nước cao nhất của nước Cộng hòa xã hội chủ nghĩa Việt Nam là:",
  a:["Chính phủ","Chủ tịch nước","Quốc hội","Bộ Chính trị"],
  c:2
}
];

/* ===== BIẾN ===== */
let name="", idx=0, answers=[];
let startTime, timer;
const totalTime = questions.length * 180;

/* ===== START ===== */
function start(){
  name=document.getElementById("username").value.trim();
  if(!name){alert("Vui lòng nhập tên");return;}
  startTime=Date.now();
  document.getElementById("start").classList.add("hidden");
  document.getElementById("quiz").classList.remove("hidden");
  buildNav();
  load();
  countdown();
}

/* ===== TIMER ===== */
function countdown(){
  timer=setInterval(()=>{
    let left=totalTime-Math.floor((Date.now()-startTime)/1000);
    document.getElementById("time").innerText=
      Math.floor(left/60)+":"+String(left%60).padStart(2,"0");
    if(left<=0){clearInterval(timer);finish(true);}
  },1000);
}

/* ===== NAV ===== */
function buildNav(){
  const nav=document.getElementById("nav");
  nav.innerHTML="";
  questions.forEach((_,i)=>{
    let d=document.createElement("div");
    d.innerText=i+1;
    d.onclick=()=>{idx=i;load();}
    nav.appendChild(d);
  });
}

/* ===== LOAD ===== */
function load(){
  document.getElementById("nextBtn").classList.add("hidden");
  document.getElementById("finishBtn").classList.add("hidden");
  document.getElementById("qtext").innerText=`Câu ${idx+1}: ${questions[idx].q}`;

  const box=document.getElementById("answers");
  box.innerHTML="";

  questions[idx].a.forEach((t,i)=>{
    let b=document.createElement("button");
    b.className="answer";
    b.innerText=t;
    if(answers[idx]===i) b.classList.add("selected");
    b.onclick=()=>select(i);
    box.appendChild(b);
  });

  if(answers.filter(a=>a!==undefined).length===questions.length){
    document.getElementById("finishBtn").classList.remove("hidden");
  }
}

/* ===== SELECT ===== */
function select(i){
  answers[idx]=i;
  document.getElementById("clickSound").play();
  document.querySelectorAll(".answer").forEach(b=>b.classList.remove("selected"));
  document.querySelectorAll(".answer")[i].classList.add("selected");
  updateNav();
  document.getElementById("nextBtn").classList.remove("hidden");
}

/* ===== NEXT ===== */
function next(){
  if(answers[idx]===undefined){
    const card=document.getElementById("qtext");
    card.classList.add("shake");
    setTimeout(()=>card.classList.remove("shake"),300);
    return;
  }
  idx++;
  load();
}

/* ===== NAV COLOR ===== */
function updateNav(){
  document.querySelectorAll(".nav div").forEach((d,i)=>{
    if(answers[i]!==undefined) d.className="done";
  });
}

/* ===== FINISH ===== */
function finish(auto=false){
  if(!auto && !confirm("Xác nhận hoàn thành bài làm?")) return;
  clearInterval(timer);

  let score=0;
  let html=`<h2>KẾT QUẢ</h2>
  <p><b>Người làm bài:</b> ${name}</p>`;

  html+=`<div class="nav">`;
  questions.forEach((q,i)=>{
    let c=answers[i]===q.c?"correct":"wrong";
    if(answers[i]===q.c) score++;
    html+=`<div class="${c}">${i+1}</div>`;
  });
  html+=`</div><p><b>Đúng:</b> ${score}/${questions.length}</p>`;

  document.getElementById("quiz").classList.add("hidden");
  document.getElementById("result").innerHTML=html;
  document.getElementById("result").classList.remove("hidden");
}
</script>
</body>
</html>
